#!/bin/bash

# Configuration R pour ignorer SSL
echo 'options(download.file.extra = "--insecure")' >> ~/.Rprofile
echo 'export PYTHONHTTPSVERIFY=0' >> ~/.bashrc
echo 'export CURL_CA_BUNDLE=""' >> ~/.bashrc

# Configuration RStudio Server (si les droits le permettent)
mkdir -p ~/.config/rstudio 2>/dev/null || true
cat > ~/.config/rstudio/rstudio-prefs.json << EOF
{
    "ssl_verify_peer": false,
    "ssl_verify_host": false
}
EOF

# Configuration système pour ignorer SSL
echo "check_certificate = off" >> ~/.wgetrc 2>/dev/null || true
echo "insecure" >> ~/.curlrc 2>/dev/null || true

echo "Configuration SSL bypass complète terminée"

# Install R package
# if not available as conda package
R -e "install.packages('diagram', repos='http://cran.rstudio.com/')"
R -e "install.packages('fastmap', repos='http://cran.rstudio.com/')"
#R -e "install.packages('swirl', repos='http://cran.rstudio.com/', dependencies = TRUE)"
#R -e "install.packages('Rcpp', repos='http://cran.rstudio.com/')"

# Install R/Bioconductor package
# if not available as conda package

# First install Bioconductor package manager
# https://bioconductor.org/install/
R -e "install.packages('BiocManager', repos='http://cran.rstudio.com/')"
R -e "BiocManager::install()"

# Then install required packages
# Biostrings: Efficient manipulation of biological strings
# https://bioconductor.org/packages/release/bioc/html/Biostrings.html
R -e "BiocManager::install('Biostrings', update = FALSE)"
R -e "BiocManager::install('biomaRt', update = FALSE)"
R -e "BiocManager::install('limma', update = FALSE)"
